<html>
  <head>
    <title>Raycasting Demo</title>
    <link rel="stylesheet" href="./style.css">
  </head>
  <body>
    <canvas id="scene"></canvas>
    <div style="display:none;">
      <audio id="aggressormusic">
        <source src="./sounds/aggressor-whitebataudio.mp3" type="audio/mp3">
      </audio>
      <audio id="lawabidingcitizenmusic">
        <source src="./sounds/lawabidingcitizen-whitebataudio.mp3" type="audio/mp3">
      </audio>
      <audio id="neuromancermusic">
        <source src="./sounds/neuromancer-whitebataudio.mp3" type="audio/mp3">
      </audio>
      <audio id="rebelsmusic">
        <source src="./sounds/rebels-whitebataudio.mp3" type="audio/mp3">
      </audio>
      <audio id="darkmagic">
        <source src="./sounds/darkmagic.flac" type="audio/flac">
      </audio>
      <audio id="death">
        <source src="./sounds/Death.wav" type="audio/wav">
      </audio>
      <audio id="developers">
        <source src="./sounds/developers.mp3" type="audio/mp3">
      </audio>
      <audio id="growl">
        <source src="./sounds/growl.wav" type="audio/wav">
      </audio>
      <audio id="heal">
        <source src="./sounds/heal.wav" type="audio/wav">
      </audio>
      <audio id="reload">
        <source src="./sounds/reload.wav" type="audio/wav">
      </audio>
      <audio id="shot">
        <source src="./sounds/shot.wav" type="audio/wav">
      </audio>
      <audio id="shotgunfire">
        <source src="./sounds/shotgunfire.wav" type="audio/wav">
      </audio>
      <audio id="spirit">
        <source src="./sounds/spirit.wav" type="audio/wav">
      </audio>      
      <audio id="spell">
        <source src="./sounds/spell.wav" type="audio/wav">
      </audio>    
      <audio id="drill">
        <source src="./sounds/drill.mp3" type="audio/mp3">
      </audio> 
    </div>
    <div style="display:none;">
      <img id="walls" src="./resources/brick.png"/>
      <img id="billboards" src="./resources/billboards.png"/>
      <img id="floors" src="./resources/floors.png"/>
      <img id="skybox" src="./resources/nightskybox.png"/>
      <img id="defaultScrewDriver" src="./resources/defaultScrewDriver.png"/>
      <img src="./resources/attackScrewDriver.png"/>
      <img src="./resources/sparks.png"/>
      <img src="./resources/couch.png"/>
      <img src="./resources/trashcan.png"/>
      <img src="./resources/drywall.png"/>
      <img src="./resources/computerdesk.png"/>
      <img src="./resources/pottedplant.png"/>
      <img src="./resources/enemyturret.png"/>
      <img src="./resources/enemyturretattack.png"/>
      <img src="./resources/enemyturretdestroyed.png"/>
      <img src="./resources/enemyshot.png"/>
      <img src="./resources/pistolpowerup.png"/>
      <img src="./resources/bulletprojectile.png"/>
      <img src="./resources/defaultPistol.png"/>
      <img src="./resources/attackPistol.png"/>
      <img src="./resources/ammopowerup.png"/>
      <img src="./resources/healthpowerup.png"/>
      <img src="./resources/vent.png"/>
      <img src="./resources/cobblestone.png"/>
      <img src="./resources/cobblestonetall.png"/>
      <img src="./resources/fireaxe.png"/>
      <img src="./resources/fireaxeattack.png"/>
      <img src="./resources/fireaxepowerup.png"/>
      <img src="./resources/bluesparks.png"/>
      <img src="./resources/npc_melee_attack.png"/>
      <img src="./resources/npc_melee_move.png"/>
      <img src="./resources/ar.png"/>
      <img src="./resources/arattack.png"/>
      <img src="./resources/arreload.png"/>
      <img src="./resources/arpowerup.png"/>
      <img src="./resources/wallpaper.png"/>
      <img src="./resources/carpet.png"/>
      <img src="./resources/brickwindow.png"/>
      <img src="./resources/ceilingDryWall.png"/>
      <img src="./resources/wallpaperdoor.png"/>
      <img id="skyboxblank" src="./resources/skyboxblank.png"/>
      <img src="./resources/wallpapervent.png"/>
      <img src="./resources/elevatordoors.png"/>
      <img src="./resources/pistolreload.png"/>
      <img src="./resources/deaddude.png"/>
      <img src="./resources/fridge.png"/>
      <img src="./resources/comfychair.png"/>
      <img src="./resources/tv.png"/>
      <img src="./resources/bed.png"/>
      <img src="./resources/endtable.png"/>
      <img src="./resources/statue.png"/>
      <img src="./resources/enemyrangedmove.png"/>
      <img src="./resources/enemyrangedattack.png"/>
      <img src="./resources/enemyrangeddeath.png"/>
      <img src="./resources/streetlamp.png"/>
      <img src="./resources/exitsign.png"/>
      <img src="./resources/bush.png"/>
      <img src="./resources/cardboardbox.png"/>
      <img src="./resources/shotgun.png"/>
      <img src="./resources/shotgunattack.png"/>
      <img src="./resources/shotgunreload.png"/>
      <img src="./resources/shotgunpowerup.png"/>
      <img src="./resources/shotgunblast.png"/>
      <img src="./resources/hellraiser.png"/>
      <img src="./resources/hellraiserattack.png"/>
      <img src="./resources/hellraiserdeath.png"/>
      <img src="./resources/introtoc.png"/>
      <img src="./resources/introtocattack.png"/>
      <img src="./resources/introtocpowerup.png"/>
      <img src="./resources/darkblades.png"/>
      <img src="./resources/grass.png"/>
      <img src="./resources/sidewalk1.png"/>
      <img src="./resources/sidewalk2.png"/>
      <img src="./resources/sidewalk3.png"/>
      <img src="./resources/sidewalk4.png"/>
      <img src="./resources/sidewalk5.png"/>
      <img src="./resources/sidewalk6.png"/>
      <img src="./resources/sidewalk7.png"/>
      <img src="./resources/sidewalk8.png"/>
      <img src="./resources/sidewalk9.png"/>
      <img src="./resources/sidewalk10.png"/>
      <img src="./resources/sidewalk11.png"/>
      <img src="./resources/sidewalk12.png"/>
      <img src="./resources/sidewalk13.png"/>
      <img src="./resources/sidewalk14.png"/>
      <img src="./resources/sidewalk17.png"/>
      <img src="./resources/sidewalk18.png"/>
      <img src="./resources/sidewalk19.png"/>
      <img src="./resources/sidewalk20.png"/>
      <img src="./resources/sidewalk21.png"/>
      <img src="./resources/concrete1.png"/>
      <img src="./resources/concrete2.png"/>
      <img src="./resources/concrete3.png"/>
      <img src="./resources/concrete4.png"/>
      <img src="./resources/concrete5.png"/>
      <img src="./resources/concrete6.png"/>
      <img src="./resources/concrete7.png"/>
      <img src="./resources/concrete8.png"/>
      <img src="./resources/crosswalk1.png"/>
      <img src="./resources/crosswalk2.png"/>
    </div>
  </body>
</html>
<script src="AudioHandler.js"></script>
<script src="Main.js"></script>
<script src="Camera.js"></script>
<script src="Level.js"></script>
<script src="RayCaster.js"></script>
<script src="Data.js"></script>
<script src="Animation.js"></script>
<script src="Billboard.js"></script>
<script src="Enemy.js"></script>
<script src="Projectile.js"></script>
<script src="Weapon.js"></script>
<script src="Powerup.js"></script>
<script src="Teleport.js"></script>
<script src="./Levels/TestLevel.js"></script>
<script src="./Levels/TestStreets.js"></script>
<script src="./Levels/ApartmentLevel4.js"></script>
<script>
  var cvs = document.getElementById("scene");
  var main;
  var pointerLocked = false;

  window.onload = function() {
    cvs.width = 240;
    cvs.height = 135;
    let aspectRatio = cvs.width / cvs.height;
    let width = window.innerWidth;
    if (window.innerWidth / aspectRatio > window.innerHeight) {
      width = window.innerHeight * aspectRatio;
    }
    cvs.style.width = width + "px";
    cvs.style.height = width / aspectRatio + "px";
    let ctx = cvs.getContext("2d");
    ctx.font = "10px MS Gothic";

    main = new Main(ctx);
    main.initialize();
  };

  window.onresize = function(){
    let aspectRatio = cvs.width / cvs.height;
    let width = window.innerWidth;
    if (window.innerWidth / aspectRatio > window.innerHeight) {
      width = window.innerHeight * aspectRatio;
    }
    cvs.style.width = width + "px";
    cvs.style.height = width / aspectRatio + "px";
  };

  document.addEventListener('keydown', function(event) {
    if (main != undefined)
      main.handleKeyDown(event.keyCode);
  });

  document.addEventListener('keyup', function(event) {
    if (main != undefined)
      main.handleKeyUp(event.keyCode);
  });

  document.addEventListener('mousemove', function (event) {
    if (main != undefined && pointerLocked)
      main.handleMouseMove(event.movementX);
  });

  document.addEventListener('mouseup', function (event) {
    if (main != undefined && !pointerLocked) 
      cvs.requestPointerLock();

    if (main != undefined && pointerLocked) 
      main.handleMouseUp();
  });

  document.addEventListener('mousedown', function (event) {
    if (main != undefined && pointerLocked) 
      main.handleMouseDown();
  });

  document.addEventListener('pointerlockchange', function (event) {
    pointerLocked = !pointerLocked;
  });
</script>