<html>
  <head>
    <title>Raycasting Demo</title>
    <link rel="stylesheet" href="./style.css">
  </head>
  <body>
    <canvas id="scene"></canvas>
    <div style="display:none;">
      <img id="walls" src="./resources/walls.png"/>
      <img id="billboards" src="./resources/billboards.png"/>
      <img id="floors" src="./resources/floors.png"/>
      <img id="skybox" src="./resources/skybox.png"/>
      <img id="defaultScrewDriver" src="./resources/defaultScrewDriver.png"/>
      <img src="./resources/attackScrewDriver.png"/>
      <img src="./resources/sparks.png"/>
      <img src="./resources/couch.png"/>
      <img src="./resources/trashcan.png"/>
      <img src="./resources/drywall.png"/>
      <img src="./resources/computerdesk.png"/>
      <img src="./resources/pottedplant.png"/>
      <img src="./resources/enemyturret.png"/>
      <img src="./resources/enemyturretattack.png"/>
      <img src="./resources/enemyturretdestroyed.png"/>
      <img src="./resources/enemyshot.png"/>
      <img src="./resources/pistolpowerup.png"/>
      <img src="./resources/bulletprojectile.png"/>
      <img src="./resources/defaultPistol.png"/>
      <img src="./resources/attackPistol.png"/>
      <img src="./resources/ammopowerup.png"/>
      <img src="./resources/healthpowerup.png"/>
    </div>
  </body>
</html>
<script src="Main.js"></script>
<script src="Camera.js"></script>
<script src="Level.js"></script>
<script src="RayCaster.js"></script>
<script src="Data.js"></script>
<script src="Animation.js"></script>
<script src="Billboard.js"></script>
<script src="Enemy.js"></script>
<script src="Projectile.js"></script>
<script src="Weapon.js"></script>
<script src="Powerup.js"></script>
<script>
  var cvs = document.getElementById("scene");
  var main;
  var pointerLocked = false;

  window.onload = function() {
    cvs.width = 240;
    cvs.height = 135;
    let aspectRatio = cvs.width / cvs.height;
    cvs.style.width = window.innerWidth + "px";
    cvs.style.height = window.innerWidth / aspectRatio + "px";
    let ctx = cvs.getContext("2d");
    ctx.font = "10px MS Gothic";

    main = new Main(ctx);
    main.initialize();
  };

  window.onresize = function(){
    let aspectRatio = cvs.width / cvs.height;
    cvs.style.width = window.innerWidth + "px";
    cvs.style.height = window.innerWidth / aspectRatio + "px";
  };

  document.addEventListener('keydown', function(event) {
    if (main != undefined)
      main.handleKeyDown(event.keyCode);
  });

  document.addEventListener('keyup', function(event) {
    if (main != undefined)
      main.handleKeyUp(event.keyCode);
  });

  document.addEventListener('mousemove', function (event) {
    if (main != undefined && pointerLocked)
      main.handleMouseMove(event.movementX);
  });

  document.addEventListener('mouseup', function (event) {
    if (main != undefined && !pointerLocked) 
      cvs.requestPointerLock();

    if (main != undefined && pointerLocked) 
      main.handleMouseUp();
  });

  document.addEventListener('mousedown', function (event) {
    if (main != undefined && pointerLocked) 
      main.handleMouseDown();
  });

  document.addEventListener('pointerlockchange', function (event) {
    pointerLocked = !pointerLocked;
  });
</script>